# test_rag_calculator.py

**File:** `../source-code/tests/test_rag_calculator.py`

---

## sample_accounts

### Signature
```python
def sample_accounts(spark)
```

### Description
Create sample accounts DataFrame.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |

### Decorators
- `@pytest.fixture`

*Classification: business_logic (medium confidence)*
*Reason: Matches 1 business logic patterns*

---

## test_red_status_50_percent_increase

### Signature
```python
def test_red_status_50_percent_increase(spark, sample_accounts)
```

### Description
Test that 50%+ increase results in RED status.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 3 business logic patterns*

---

## test_amber_status_35_percent_increase

### Signature
```python
def test_amber_status_35_percent_increase(spark, sample_accounts)
```

### Description
Test that 30-49% increase results in AMBER status.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 3 business logic patterns*

---

## test_green_status_20_percent_increase

### Signature
```python
def test_green_status_20_percent_increase(spark, sample_accounts)
```

### Description
Test that <30% increase results in GREEN status.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 3 business logic patterns*

---

## test_green_status_new_customer_no_previous_month

### Signature
```python
def test_green_status_new_customer_no_previous_month(spark, sample_accounts)
```

### Description
Test that new customers with no previous month data get GREEN status.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 3 business logic patterns*

---

## test_order_limit_exceeded

### Signature
```python
def test_order_limit_exceeded(spark, sample_accounts)
```

### Description
Test that exceeding order limit is flagged.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 2 business logic patterns*

---

## test_order_limit_not_exceeded

### Signature
```python
def test_order_limit_not_exceeded(spark, sample_accounts)
```

### Description
Test that staying within order limit is not flagged.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 2 business logic patterns*

---

## test_exactly_30_percent_is_amber

### Signature
```python
def test_exactly_30_percent_is_amber(spark, sample_accounts)
```

### Description
Test that exactly 30% increase results in AMBER (boundary case).

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 2 business logic patterns*

---

## test_exactly_50_percent_is_red

### Signature
```python
def test_exactly_50_percent_is_red(spark, sample_accounts)
```

### Description
Test that exactly 50% increase results in RED (boundary case).

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 2 business logic patterns*

---

## test_decrease_in_orders_is_green

### Signature
```python
def test_decrease_in_orders_is_green(spark, sample_accounts)
```

### Description
Test that a decrease in orders results in GREEN status.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 3 business logic patterns*

---
