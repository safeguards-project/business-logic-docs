# test_rag_calculator.py

**File:** `../source-code/tests/test_rag_calculator.py`

---

## sample_accounts

### Signature
```python
def sample_accounts(spark)
```

### Description
Create sample accounts DataFrame.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |

### Decorators
- `@pytest.fixture`

*Classification: business_logic (medium confidence)*
*Reason: Matches 1 business logic patterns*

---

## test_valid_records_go_to_result_table

### Signature
```python
def test_valid_records_go_to_result_table(spark, sample_accounts, sample_orders)
```

### Description
Test that valid records go to result_table, not holding_table.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |
| `sample_orders` | - | - |

*Classification: business_logic (medium confidence)*
*Reason: Matches 1 business logic patterns*

---

## test_missing_customer_name_routed_to_holding

### Signature
```python
def test_missing_customer_name_routed_to_holding(spark)
```

### Description
Test that records with missing customer_name go to holding_table.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 2 business logic patterns*

---

## test_missing_order_limit_routed_to_holding

### Signature
```python
def test_missing_order_limit_routed_to_holding(spark)
```

### Description
Test that records with missing order_limit go to holding_table.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 2 business logic patterns*

---

## test_holding_table_has_hold_timestamp

### Signature
```python
def test_holding_table_has_hold_timestamp(spark)
```

### Description
Test that holding_table records include hold_timestamp.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 2 business logic patterns*

---

## test_result_table_has_expected_columns

### Signature
```python
def test_result_table_has_expected_columns(spark, sample_accounts, sample_orders)
```

### Description
Test that result_table has all expected columns.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |
| `sample_accounts` | - | - |
| `sample_orders` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 2 business logic patterns*

---

## test_holding_table_has_expected_columns

### Signature
```python
def test_holding_table_has_expected_columns(spark)
```

### Description
Test that holding_table has all expected columns.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 2 business logic patterns*

---

## test_mixed_valid_and_invalid_records

### Signature
```python
def test_mixed_valid_and_invalid_records(spark)
```

### Description
Test that valid and invalid records are correctly split.

### Parameters
| Name | Type | Default |
|------|------|---------|
| `spark` | - | - |

*Classification: business_logic (high confidence)*
*Reason: Matches 2 business logic patterns*

---
